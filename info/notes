Should have had unit tests because it would have been obvious that the oscillation function was broken for so long.