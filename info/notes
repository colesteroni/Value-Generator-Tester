Should have had unit tests because it would have been obvious that the oscillation function was broken for so long.

More individual commits from v0.5 on.